<div class="col-md-12">
	<div *ngIf="restaurante">
		<div class="row">
			<div class="col-md-3" *ngIf="restaurante.imagen">
				<img alt="Imagen Principal del Restaurante" src="{{restaurante.imagen}}" class="img-rounded imagen-detalle">
			</div>
			<div class="col-lg-3" *ngIf="!restaurante.imagen">
			<img src="https://image.flaticon.com/icons/png/512/45/45586.png" class="img-rounded imagen-detalle"/>
			</div>
			<div class="col-md-9">
				<div class="col-md-7 thumbnail">
					<h3 class="text-primary text-center">
						{{restaurante.nombre}}
					</h3>
					<p> Dirección: {{restaurante.direccion}}</p>
					<p> Puntuación: {{avg}} </p>
					<div *ngIf="!propietario">
						<div *ngIf="(!solicitado) && (!hayPeticion) && (hayUsuario)">
							<p> <a (click)="esSolicitado()"> ¿Eres propietario de este negocio? Solicítalo </a></p>
						</div>
						<div *ngIf="(!solicitado) && (!hayPeticion) && (!hayUsuario)">
							<p> <a [routerLink]="['/crear-usuarios']"> Si eres propietario de este negocio y deseas solicitarlo, es necesario que se resgistre. </a></p>
						</div>
						<div *ngIf="solicitado">
							<p><strong> A continuación se va a proceder a informar al administrador de la solicitud deseada: <i>el usuario {{usuario.nombre}} requiere los derechos de este establecimiento ({{restaurante.nombre}}). </i></strong></p>
							<p> ¿Está seguro? </p>
							<a (click)="solicitarPropiedad(restaurante.id)" class="btn btn-success">Aceptar</a>
							<a (click)="cancelarSolicitud()" class="btn btn-warning">Cancelar</a>
						</div>
						<div *ngIf="(!solicitado) && (hayPeticion)">
							<p class="text-muted"> Ha realizado una petición para ser propietario de este restaurante. Espere a que el Administrador se ponga en contacto con usted. Muchas gracias :) </p>
						</div>
					</div>
					<div *ngIf="(hayUsuario && propietario && usuario.id == userPropi.id) || (admin)">
						<div *ngIf="!confirmado">
							<button [routerLink]="['/editar-restaurantes', restaurante.id]" class="btn btn-warning">Editar</button>

							<button (click)="seguroBorrar()" class="btn btn-danger">Eliminar</button>
						</div>
						<div *ngIf="confirmado">
							<button (click)="eliminarRestaurante()" class="btn btn-danger">Estoy Seguro</button>
							<button (click)="cancelarBorrar()" class="btn btn-warning">Cancelar</button>
						</div>
					</div>

				
				
					<div class="col-md-12 thumbnail" *ngIf="propietario">
						<h4 class="text-muted text-center"> Propietario </h4>
						<p class="text-center">{{userPropi.nombre}} {{userPropi.apellido1}} {{userPropi.apellido2}} </p>
						<p class="text-center">{{userPropi.email}}</p>
					</div>
				</div>
			<div class="col-md-5">
				<agm-map 
					[latitude]="lat" 
					[longitude]="long" 
					[zoom]="zoom"
					[mapTypeId]="'terrain'"
					style="height: 250px">
		 			<agm-marker [latitude]="lat" [longitude]="long"></agm-marker>
				</agm-map>
			</div>

			</div>
		</div>
		<div class="row">
			<div class="col-md-12">
				<h3 class="text-center">
						Comentarios
				</h3>
				<!-- AQUÍ SE PODRÍA PONER UN FILTRO PARA LOS COMENTARIOS -->
				<div class="col-md-10 col-md-offset-1">
					<div class="panel panel-info" *ngFor="let opinion of opiniones | paginate: {itemsPerPage: 2, currentPage: p}">
				    	<div class="panel-heading">
				      		<h4>{{opinion.nombre}}</h4>
				      	</div>
				      	<div class="panel-body">
				      		<p>{{opinion.fecha}}</p>
							<p>{{opinion.puntuacion}} - {{opinion.mensaje}}</p>
							<button type="button" class="btn btn-success btn-sm">
								Votar
							</button>
				      	</div>
					</div>
					<pagination-controls *ngIf="opiniones" (pageChange)=" p = $event "></pagination-controls>
				</div>
				<div *ngIf="hayUsuario">
					<div class="col-md-10 col-md-offset-1 thumbnail">
						<h3 class="text-primary text-center"> Deja tu opinión </h3>
						<form role="form" #formOpinionesRest="ngForm" (ngSubmit)="onSubmitOpinion()">
							<div class="form-group">
								<div class="col-md-4">
									<label for="Puntuacion">
										Puntuación
									</label>
									<input type="number" class="form-control" id="puntuacion" #puntuacion="ngModel" name="puntuacion" [(ngModel)]="opinion.puntuacion">
								</div>
								<div class="col-md-8">
									<label for="Opinion">
										Opinión (máx 420 caracteres)
									</label>
									<textarea placeholder="Introduzca aquí su opinión (max 420 caracteres)" #mensaje="ngModel" name="mensaje" [(ngModel)]="opinion.mensaje"></textarea>
								</div>
									<input type="submit" value="Opinar" class="btn btn-info pull-right only-little-margin" [disabled]="!formOpinionesRest.form.valid"/>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>